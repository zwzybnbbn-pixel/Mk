<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ¨</title>

<style>
  body { font-family:sans-serif; background:#f1f1f1; padding:20px; }
  .container {
    background:white;
    max-width:600px;
    margin:auto;
    padding:20px;
    border-radius:12px;
    box-shadow:0 4px 20px #00000020;
  }
  input, textarea, select {
    width:100%;
    padding:10px;
    margin:8px 0;
    border-radius:6px;
    border:1px solid #ccc;
    font-size:16px;
  }
  button {
    width:100%;
    padding:12px;
    background:#1976D2;
    color:white;
    border:none;
    border-radius:6px;
    font-size:17px;
    cursor:pointer;
    margin-top:10px;
  }
  .back {
    display:block;
    text-align:center;
    margin-top:15px;
    text-decoration:none;
    color:#333;
    font-weight:bold;
  }
</style>
</head>

<body>

<div class="container">
  <h2>âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ¨</h2>

  <label>Ø§Ø³Ù… Ø§Ù„Ø·Ø¨ÙŠØ¨</label>
  <input id="name">

  <label>Ø§Ù„ØªØ®ØµØµ</label>
  <input id="specialty">

  <label>Ù…ÙƒØ§Ù† Ø§Ù„Ø¯ÙˆØ§Ù…</label>
  <input id="place">

  <label>Ø£ÙŠØ§Ù… Ø§Ù„Ø¯ÙˆØ§Ù…</label>
  <input id="days">

  <label>Ø§Ù„Ø£ÙˆÙ‚Ø§Øª</label>
  <input id="times">

  <button id="saveBtn">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>

  <a class="back" href="doctors.html">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©</a>
</div>

<script type="module">
  import { db } from "./firebase-config.js";
  import { doc, getDoc, updateDoc } 
  from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

  // Ø§Ø³ØªØ®Ø±Ø§Ø¬ ID Ø§Ù„Ø·Ø¨ÙŠØ¨
  const params = new URLSearchParams(window.location.search);
  const id = params.get("id");

  const nameInput = document.getElementById("name");
  const specialtyInput = document.getElementById("specialty");
  const placeInput = document.getElementById("place");
  const daysInput = document.getElementById("days");
  const timesInput = document.getElementById("times");
  const saveBtn = document.getElementById("saveBtn");

  // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ¨
  async function loadDoctor() {
    if (!id) {
      alert("Ø®Ø·Ø£: Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ø±Ù Ù„Ù„Ø·Ø¨ÙŠØ¨");
      return;
    }

    const ref = doc(db, "doctors", id);
    const snap = await getDoc(ref);

    if (!snap.exists()) {
      alert("Ø§Ù„Ø·Ø¨ÙŠØ¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!");
      return;
    }

    const d = snap.data();

    nameInput.value = d.name;
    specialtyInput.value = d.specialty;
    placeInput.value = d.place;
    daysInput.value = d.days;
    timesInput.value = d.times;
  }

  loadDoctor();

  // Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
  saveBtn.onclick = async () => {
    const ref = doc(db, "doctors", id);

    await updateDoc(ref, {
      name: nameInput.value,
      specialty: specialtyInput.value,
      place: placeInput.value,
      days: daysInput.value,
      times: timesInput.value
    });

    alert("âœ” ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¨Ù†Ø¬Ø§Ø­");
    window.location.href = "doctor.html?id=" + id;
  };
</script>

</body>
</html>

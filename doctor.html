<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بيانات الدكتور</title>

    <style>
        body { font-family: sans-serif; background:#f3f3f3; padding:15px; }
        .card { background:white; padding:20px; border-radius:12px; margin-bottom:20px; }
        h2 { color:#0077ff; text-align:center; margin-bottom:15px; }
        table { width:100%; border-collapse:collapse; margin-top:15px; background:white; }
        th, td { padding:12px; border:1px solid #ddd; text-align:center; }
        th { background:#0077ff; color:white; font-size:18px; }
        td { font-size:16px; }
    </style>
</head>

<body>

<div class="card">
    <h2>بيانات الدكتور</h2>
    <p><b>الاسم:</b> <span id="docName"></span></p>
    <p><b>التخصص:</b> <span id="docSpec"></span></p>
    <p><b>رقم الهاتف:</b> <span id="docPhone"></span></p>
    <p><b>المستشفى:</b> <span id="docHospital"></span></p>
</div>

<div class="card">
    <h2>جدول الدوام</h2>
    <table>
        <thead>
            <tr>
                <th>اليوم</th>
                <th>الوقت</th>
            </tr>
        </thead>
        <tbody id="scheduleBody"></tbody>
    </table>
</div>

<script type="module">
import { db } from "./firebase-config.js";
import { doc, getDoc } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

// الحصول على ID من الرابط
const params = new URLSearchParams(window.location.search);
const doctorId = params.get("id");

// تحميل بيانات الطبيب
async function loadDoctor() {
    if (!doctorId) {
        alert("لا يوجد طبيب بهذا الرقم!");
        return;
    }

    const ref = doc(db, "doctors", doctorId);
    const snap = await getDoc(ref);

    if (!snap.exists()) {
        alert("لم يتم العثور على الطبيب!");
        return;
    }

    const d = snap.data();

    // تعبئة بيانات الدكتور
    document.getElementById("docName").textContent = d.name;
    document.getElementById("docSpec").textContent = d.specialty;
    document.getElementById("docPhone").textContent = d.phone;
    document.getElementById("docHospital").textContent = d.hospital;

    // جدول الدوام
    const body = document.getElementById("scheduleBody");
    const days = [
        ["saturday", "السبت"],
        ["sunday", "الأحد"],
        ["monday", "الاثنين"],
        ["tuesday", "الثلاثاء"],
        ["wednesday", "الأربعاء"],
        ["thursday", "الخميس"],
        ["friday", "الجمعة"]
    ];

    days.forEach(([key, label]) => {
        const time = d.schedule[key]?.time ?? "—";
        body.innerHTML += `
            <tr>
                <td>${label}</td>
                <td>${time}</td>
            </tr>
        `;
    });
}

loadDoctor();
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ù…Ù„Ù Ø§Ù„Ø·Ø¨ÙŠØ¨</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<h2 style="text-align:center;">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ù„Ù„Ø·Ø¨ÙŠØ¨</h2>
<div id="profile" class="profile-card">Ø¬Ø§Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>

<script type="module">
import { db } from "./firebase.js";
import { doc, getDoc } 
from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

// Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù€ ID Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
const id = new URLSearchParams(window.location.search).get("id");

async function loadDoctor(){
    const ref = doc(db, "doctors", id);
    const snap = await getDoc(ref);

    if(!snap.exists()){
        document.getElementById("profile").innerHTML = "<h3>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ø¨ÙŠØ¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…</h3>";
        return;
    }

    const d = snap.data();

    document.getElementById("profile").innerHTML = `
      <h2>${d.name}</h2>
      <p><strong>Ø§Ù„ØªØ®ØµØµ:</strong> ${d.specialty}</p>
      <p><strong>Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰:</strong> ${d.hospital}</p>
      <p><strong>Ø§Ù„Ø¯ÙˆØ§Ù…:</strong> ${d.time}</p>
      <p><strong>Ø§Ù„Ù‡Ø§ØªÙ:</strong> ${d.phone}</p>
      <p>${d.bio}</p>
      <a class="btn" href="doctors.html">Ø¹ÙˆØ¯Ø©</a>
    `;
}

loadDoctor();
</script>

</body>
</html>ing: 10px 15px;
            border-radius: 8px;
            text-decoration: none;
            margin-top: 15px;
        }
    </style>
</head>

<body>

<header>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ¨</header>

<main class="container">
    <section id="profile">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</section>
</main>

<script src="doctors-data.js"></script>

<script>
const params = new URLSearchParams(window.location.search);
const id = params.get("id");

// Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙƒØªÙˆØ±
const doctor = doctors.find(d => d.id == id);

/* -----------------------------------------------------------
   ğŸ”¥ Ø¯Ø§Ù„Ø© ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¯ÙˆØ§Ù… Ø¨Ø´ÙƒÙ„ Ù…Ø±ØªØ¨ Ø¯Ø§Ø®Ù„ Ø¬Ø¯ÙˆÙ„
   ----------------------------------------------------------- */
function createScheduleTable(timeText) {
    const lines = timeText.split("\n");  // ØªÙ‚Ø³ÙŠÙ… ÙƒÙ„ ÙŠÙˆÙ… Ù„ÙˆØ­Ø¯Ù‡
    let rows = "";

    lines.forEach(line => {
        if (line.trim() === "") return;

        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ÙŠÙˆÙ… + Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„
        const match = line.match(/^(.*?):\s*(.*)$/);
        if (match) {
            const day = match[1];
            const times = match[2];

            rows += `
                <tr>
                    <th>${day}</th>
                    <td>${times}</td>
                </tr>
            `;
        }
    });

    return `
        <table>
            <tr>
                <th>Ø§Ù„ÙŠÙˆÙ…</th>
                <th>Ø§Ù„Ø¯ÙˆØ§Ù…</th>
            </tr>
            ${rows}
        </table>
    `;
}

/* -----------------------------------------------------------
   ğŸ”¥ Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
   ----------------------------------------------------------- */
if (doctor) {
    document.getElementById("profile").innerHTML = `
        <div class="profile-card">
            <h2>${doctor.name}</h2>

            <p><strong>Ø§Ù„ØªØ®ØµØµ:</strong> ${doctor.specialty}</p>
            <p><strong>Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰:</strong> ${doctor.hospital}</p>

            <h3>Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯ÙˆØ§Ù…</h3>
            ${createScheduleTable(doctor.time)}

            ${doctor.phone ? `<p><strong>Ø§Ù„Ù‡Ø§ØªÙ:</strong> ${doctor.phone}</p>` : ""}

            <a class="btn" href="doctors.html">Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡</a>
        </div>
    `;
} else {
    document.getElementById("profile").innerHTML = `
        <div class="profile-card">
            <h3>Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ¨.</h3>
            <a class="btn" href="doctors.html">Ø¹ÙˆØ¯Ø©</a>
        </div>
    `;
}
</script>

</body>
</html>
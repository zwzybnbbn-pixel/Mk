<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Doctor</title>

  <style>
    body {
      font-family: sans-serif;
      background:#f5f5f5;
      padding:15px;
    }

    .card {
      background:white;
      padding:15px;
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1);
      margin-bottom:20px;
    }

    table {
      width:100%;
      border-collapse:collapse;
      margin-top:10px;
      background:white;
    }

    th, td {
      border:1px solid #ccc;
      padding:8px;
      text-align:center;
    }

    th {
      background:#0077ff;
      color:white;
    }

    .back-btn {
      display:block;
      width:100%;
      padding:10px;
      background:#0077ff;
      color:white;
      text-align:center;
      border-radius:6px;
      margin-top:20px;
      text-decoration:none;
    }
  </style>
</head>

<body>

<div class="card">
  <h3 id="doctorName"></h3>
  <p><strong>التخصص:</strong> <span id="doctorSpecialty"></span></p>
  <p><strong>رقم الهاتف:</strong> <span id="doctorPhone"></span></p>
</div>

<table>
  <thead>
    <tr>
      <th>اليوم</th>
      <th>المستشفى</th>
      <th>الوقت</th>
    </tr>
  </thead>
  <tbody id="scheduleTable"></tbody>
</table>

<a href="index.html" class="back-btn">الرجوع</a>

<!-- Firebase -->
<script type="module">
import { db } from "./firebase-config.js";
import { doc, getDoc } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

// -------- تحميل بيانات الدكتور -------
async function loadDoctor() {
  const urlParams = new URLSearchParams(window.location.search);
  const doctorId = urlParams.get("id");

  const docRef = doc(db, "doctors", doctorId);
  const snap = await getDoc(docRef);

  if (!snap.exists()) {
    alert("الدكتور غير موجود !");
    return;
  }

  const data = snap.data();

  document.getElementById("doctorName").textContent = data.name;
  document.getElementById("doctorSpecialty").textContent = data.specialty;
  document.getElementById("doctorPhone").textContent = data.phone;

  const schedule = data.schedule;
  const table = document.getElementById("scheduleTable");

  const days = [
    { key:"sunday", label:"الأحد" },
    { key:"monday", label:"الاثنين" },
    { key:"tuesday", label:"الثلاثاء" },
    { key:"wednesday", label:"الأربعاء" },
    { key:"thursday", label:"الخميس" },
    { key:"friday", label:"الجمعة" },
    { key:"saturday", label:"السبت" }
  ];

  days.forEach(d => {
    const dayData = schedule[d.key];

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${d.label}</td>
      <td>${dayData?.hospital || "-"}</td>
      <td>${dayData?.time || "-"}</td>
    `;
    table.appendChild(tr);
  });
}

loadDoctor();
</script>

</body>
</html>
